"use strict";(self.webpackChunk_420_w_50_sf=self.webpackChunk_420_w_50_sf||[]).push([[7872],{8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>r});var t=s(6540);const i={},o=t.createContext(i);function l(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(o.Provider,{value:n},e.children)}},9266:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>l,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"Notes de cours/joystick","title":"Le *Joystick* \u2014 Pr\xe9sentation compl\xe8te","description":"1. Qu\u2019est-ce qu\u2019un Joystick\u202f?","source":"@site/docs/Notes de cours/15-joystick.md","sourceDirName":"Notes de cours","slug":"/Notes de cours/joystick","permalink":"/420-W50-SF/docs/Notes de cours/joystick","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":15,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Le *Push Button* (Bouton-poussoir) \u2014 Pr\xe9sentation compl\xe8te","permalink":"/420-W50-SF/docs/Notes de cours/pushbutton"}}');var i=s(4848),o=s(8453);const l={},r="Le Joystick \u2014 Pr\xe9sentation compl\xe8te",c={},a=[{value:"1. Qu\u2019est-ce qu\u2019un <em>Joystick</em>\u202f?",id:"1-quest-ce-quun-joystick",level:2},{value:"2. Lecture des pins",id:"2-lecture-des-pins",level:2},{value:"3. Debouncing du bouton",id:"3-debouncing-du-bouton",level:2}];function d(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsxs)(n.h1,{id:"le-joystick--pr\xe9sentation-compl\xe8te",children:["Le ",(0,i.jsx)(n.em,{children:"Joystick"})," \u2014 Pr\xe9sentation compl\xe8te"]})}),"\n",(0,i.jsxs)(n.h2,{id:"1-quest-ce-quun-joystick",children:["1. Qu\u2019est-ce qu\u2019un ",(0,i.jsx)(n.em,{children:"Joystick"}),"\u202f?"]}),"\n",(0,i.jsxs)(n.p,{children:["Le ",(0,i.jsx)(n.em,{children:"joystick"})," est un capteur analogique permettant de d\xe9tecter des mouvements dans deux directions principales :"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"X (horizontal) : gauche / droite"}),"\n",(0,i.jsx)(n.li,{children:"Y (vertical) : haut / bas"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Il est souvent \xe9quip\xe9 d\u2019un bouton poussoir int\xe9gr\xe9 pour effectuer une action lors de l\u2019appui."}),"\n",(0,i.jsx)(n.p,{children:"Broches typiques, on choisi 3 pins digitales :"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"JOY_X \u2192 axe horizontal"}),"\n",(0,i.jsx)(n.li,{children:"JOY_Y \u2192 axe vertical"}),"\n",(0,i.jsx)(n.li,{children:"JOY_BTN \u2192 bouton"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"2-lecture-des-pins",children:"2. Lecture des pins"}),"\n",(0,i.jsxs)(n.p,{children:["Seule la pin du bouton sera configur\xe9e en ",(0,i.jsx)(n.em,{children:"pinMode"}),". Tout comme le ",(0,i.jsx)(n.em,{children:"push button"})," on utilisera la r\xe9sistance interne du micro-contr\xf4leur :"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"pinMode(JOY_BTN, INPUT_PULLUP);\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Rappel"})," : L'\xe9tat ",(0,i.jsx)(n.em,{children:"LOW"})," signifie que le courant passe, le contraire pour ",(0,i.jsx)(n.em,{children:"HIGH"})]}),"\n",(0,i.jsx)(n.p,{children:"Pour lire les donn\xe9es :"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"int xVal = analogRead(JOY_X);  // 0 (gauche) \u2192 max (droite)\nint yVal = analogRead(JOY_Y);  // 0 (haut) \u2192 max (bas)\nint swVal = digitalRead(JOY_BTN); // LOW si appuy\xe9, HIGH si rel\xe2ch\xe9\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Les valeurs possibles en X et en Y varient de ",(0,i.jsx)(n.strong,{children:"0 \xe0 4095"}),". Lorsque le ",(0,i.jsx)(n.em,{children:"joystick"})," est rel\xe2ch\xe9, sa position est au centre, soit ",(0,i.jsx)(n.strong,{children:"2048"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["La zone de repos (zone pour laquelle on ne d\xe9tectera pas d'action du ",(0,i.jsx)(n.em,{children:"joystick"}),") est souvent consid\xe9r\xe9e entre ",(0,i.jsx)(n.strong,{children:"1000 et 3000"}),", ce qui fait que ces 2 valeurs deviennent les bornes de d\xe9tection :"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"void loop() {\n  int xVal = analogRead(JOY_X);  \n  int yVal = analogRead(JOY_Y);  \n  int swVal = digitalRead(JOY_BTN);\n\n  if (yVal < 1000) {\n      // Joystick vers le haut\n  } else if (yVal > 3000) {\n      // Joystick vers le bas\n  }\n\n  if (xVal < 1000) {\n      // Joystick vers la gauche\n  } else if (xVal > 3000) {\n      // Joystick vers la droite\n  }\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["On remarque que la boucle ici n'a pas de ",(0,i.jsx)(n.em,{children:"delay"})," afin d'offrir une exp\xe9rience plus fluide. Il faut faire cependant attention car maintenir le ",(0,i.jsx)(n.em,{children:"joystick"})," enfonc\xe9 dans une direction provoquerait des lectures \xe0 r\xe9p\xe9tition. Ce ph\xe9nom\xe8ne se controle facilement avec la capture du mouvement et un d\xe9lai raisonnable de 200 ms :"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"void loop() {\n  int xVal = analogRead(JOY_X);  \n  int yVal = analogRead(JOY_Y);  \n  int swVal = digitalRead(JOY_BTN);\n\n  static unsigned long lastMove = 0; ///statique !!\n  unsigned long now = millis();\n\n  if (now - lastMove > 200) {\n    if (yVal < 1000) {\n        // Joystick vers le haut\n        lastMove = now;\n    } else if (yVal > 3000) {\n        // Joystick vers le bas\n        lastMove = now;\n    }\n\n    if (xVal < 1000) {\n        // Joystick vers la gauche\n        lastMove = now;\n    } else if (xVal > 3000) {\n        // Joystick vers la droite\n        lastMove = now;\n    }\n  }\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Dans le code pr\xe9c\xe9dent, si l'on maintient le ",(0,i.jsx)(n.em,{children:"joystick"})," dans sa position, on effectuera l'action cible au 200 ms (d\xe9filement d'un menu par exemple)."]}),"\n",(0,i.jsx)(n.h2,{id:"3-debouncing-du-bouton",children:"3. Debouncing du bouton"}),"\n",(0,i.jsxs)(n.p,{children:["Pour le clic du bouton, nous observons ici le m\xeame ph\xe9nom\xe8ne de ",(0,i.jsx)(n.strong,{children:"debouncing"})," qu'avec le *push button. Ce ph\xe9nom\xe8ne peut \xeatre r\xe9gl\xe9 de la m\xeame fa\xe7on :"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"  bool buttonPressed = false;\n\n  if (swVal == LOW && !buttonPressed) {\n    buttonPressed = true;\n  } else if (swVal == HIGH) {\n    buttonPressed = false;\n  }\n"})})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);