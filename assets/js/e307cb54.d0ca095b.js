"use strict";(self.webpackChunk_420_w_50_sf=self.webpackChunk_420_w_50_sf||[]).push([[9876],{5533:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>u,frontMatter:()=>a,metadata:()=>r,toc:()=>i});const r=JSON.parse('{"id":"Notes de cours/useEffect","title":"Le Hook useEffect","description":"useEffect est un hook qui permet d\u2019ex\xe9cuter du code apr\xe8s le rendu du composant. Il est utilis\xe9 pour :","source":"@site/docs/Notes de cours/5-useEffect.md","sourceDirName":"Notes de cours","slug":"/Notes de cours/useEffect","permalink":"/420-W50-SF/docs/Notes de cours/useEffect","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Introduction aux Styles dans React Native","permalink":"/420-W50-SF/docs/Notes de cours/layoutStyles"},"next":{"title":"Introduction \xe0 Axios et Architecture API dans React Native","permalink":"/420-W50-SF/docs/Notes de cours/appelsApi"}}');var t=s(4848),c=s(8453);const a={},d="Le Hook useEffect",l={},i=[{value:"Syntaxe de base",id:"syntaxe-de-base",level:2},{value:"Les d\xe9pendances",id:"les-d\xe9pendances",level:2},{value:"Cas 1 : Tableau vide",id:"cas-1--tableau-vide",level:3},{value:"Cas 2 : Avec d\xe9pendance [maVariable]",id:"cas-2--avec-d\xe9pendance-mavariable",level:3},{value:"Cas 3 : Sans tableau de d\xe9pendances",id:"cas-3--sans-tableau-de-d\xe9pendances",level:3},{value:"Use effect avec retour de fonction",id:"use-effect-avec-retour-de-fonction",level:2},{value:"En r\xe9sum\xe9",id:"en-r\xe9sum\xe9",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsxs)(n.h1,{id:"le-hook-useeffect",children:["Le Hook ",(0,t.jsx)(n.code,{children:"useEffect"})]})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"useEffect"})," est un ",(0,t.jsx)(n.strong,{children:"hook"})," qui permet d\u2019ex\xe9cuter du code ",(0,t.jsx)(n.strong,{children:"apr\xe8s"})," le rendu du composant. Il est utilis\xe9 pour :"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Ex\xe9cuter du code une seule fois (ex : appel API)"}),"\n",(0,t.jsx)(n.li,{children:"R\xe9agir \xe0 un changement de variable"}),"\n",(0,t.jsx)(n.li,{children:"Nettoyer des effets (ex : intervalle, listener)"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"syntaxe-de-base",children:"Syntaxe de base"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"import { useEffect } from 'react';\r\n\r\nuseEffect(() => {\r\n  // Code \xe0 ex\xe9cuter apr\xe8s le rendu\r\n}, [/* d\xe9pendances */]);\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"les-d\xe9pendances",children:"Les d\xe9pendances"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"useEffect"})," se d\xe9clenche syst\xe9matiquement apr\xe8s le ",(0,t.jsx)(n.strong,{children:"premier rendu"})," du composant. Il est par contre possible de le d\xe9clencher \xe0 d'autres moments en sp\xe9cifiant des ",(0,t.jsx)(n.strong,{children:"d\xe9pendances"}),". Voici les 3 possibilit\xe9s :"]}),"\n",(0,t.jsx)(n.h3,{id:"cas-1--tableau-vide",children:"Cas 1 : Tableau vide"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'useEffect(() => {\r\n  console.log("Ce code s\'ex\xe9cute UNE SEULE FOIS");\r\n}, []);\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Le code s'ex\xe9cute ",(0,t.jsx)(n.strong,{children:"une seule fois"})," apr\xe8s le premier rendu."]}),"\n",(0,t.jsx)(n.li,{children:"Cas typique : appel API au chargement du composant."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"cas-2--avec-d\xe9pendance-mavariable",children:"Cas 2 : Avec d\xe9pendance [maVariable]"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'useEffect(() => {\r\n  console.log("maVariable a chang\xe9 :", maVariable);\r\n}, [maVariable]);\n'})}),"\n",(0,t.jsx)(n.p,{children:"Le code s\u2019ex\xe9cute :"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"apr\xe8s le premier rendu"}),"\n",(0,t.jsxs)(n.li,{children:["puis chaque fois que ",(0,t.jsx)(n.code,{children:"maVariable"})," change"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Tr\xe8s utile pour d\xe9clencher une action en r\xe9ponse \xe0 un changement de valeur."}),"\n",(0,t.jsxs)(n.p,{children:["Note : Il est aussi possible de pr\xe9ciser d'autres variables dans le tableau des d\xe9pendances si l'effet est applicable au changement de valeur de l'une ",(0,t.jsx)(n.strong,{children:"ou"})," l'autre des variables."]}),"\n",(0,t.jsx)(n.p,{children:"Pensons au retrait/ajout d'\xe9l\xe9ments dans une liste et \xe0 un filtre de recherche sur cette liste. Dans les 2 cas, le composant charg\xe9 de l'affichage de la liste doit \xeatre mis \xe0 jour dans l'effet. On aura donc la liste elle-m\xeame comme premi\xe8re variable et le filtre de recherche comme deuxi\xe8me variable."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"useEffect(() => {\r\n  //Mise \xe0 jour du composant qui affiche les items de la liste\r\n}, [theList, searchFilter]);\n"})}),"\n",(0,t.jsx)(n.p,{children:"\xc9videmment, si on veut programmer des effets diff\xe9rents dans l'application, on en rajoute d'autres :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"useEffect(() => {\r\n  //Un effet\r\n}, [maVariable1]);\r\n\r\nuseEffect(() => {\r\n  //Un autre effet diff\xe9rent du premier\r\n}, [maVariable2]);\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Avoir 2 effets diff\xe9rents sur la m\xeame variable est possible, mais \xe0 condition que la logique de l'effet soit ",(0,t.jsx)(n.strong,{children:"compl\xe8tement diff\xe9rente"}),". Par exemple une mise \xe0 jour d'un composant dans le premier effet et une journalisation (log) dans un 2e effet."]}),"\n",(0,t.jsx)(n.h3,{id:"cas-3--sans-tableau-de-d\xe9pendances",children:"Cas 3 : Sans tableau de d\xe9pendances"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'useEffect(() => {\r\n  console.log("Ce code s\'ex\xe9cute \xe0 chaque RENDU");\r\n});\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Le code s'ex\xe9cute apr\xe8s chaque rendu du composant, peu importe la cause."}),"\n",(0,t.jsx)(n.li,{children:"Rarement utilis\xe9 car cela peut entra\xeener des effets secondaires ou des performances m\xe9diocres."}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"use-effect-avec-retour-de-fonction",children:"Use effect avec retour de fonction"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"useEffect"})," ",(0,t.jsx)(n.strong,{children:"peut retourner une fonction"}),", cette fonction sera appel\xe9e dans 2 situations :"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Quand le composant est d\xe9truit (d\xe9mont\xe9)"}),"\n",(0,t.jsx)(n.li,{children:"Quand les d\xe9pendances changent"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Voici un exemple de ",(0,t.jsx)(n.code,{children:"useEffect"})," avec retour de fonction et la trace de l'ex\xe9cution :"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'useEffect(() => {\r\n  console.log("Effet lanc\xe9");\r\n\r\n  return () => {\r\n    console.log("Cleanup effectu\xe9");\r\n  };\r\n}, [count]);\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"Effet lanc\xe9 (count=0)\r\n\u2192 count devient 1\r\nCleanup effectu\xe9 (pour count=0)\r\nEffet lanc\xe9 (count=1)\r\n\u2192 count devient 2\r\nCleanup effectu\xe9 (pour count=1)\r\nEffet lanc\xe9 (count=2)\n"})}),"\n",(0,t.jsx)(n.p,{children:"Les exemples montr\xe9s plus haut ne n\xe9cessitaient pas de return. Par contre, consid\xe9rons cet effet qui d\xe9marre un timer au premier rendu :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"useEffect(() => {\r\n  const interval = setInterval(() => {\r\n    console.log('tic');\r\n  }, 1000);\r\n\r\n  return () => {\r\n    clearInterval(interval);\r\n    console.log('nettoyage');\r\n  };\r\n  //tableau vide -> premier rendu seulement\r\n}, []);\n"})}),"\n",(0,t.jsx)(n.p,{children:"Dans ce cas pr\xe9cis, un nettoyage de \"l'effet pr\xe9c\xe9dent\" est de mise afin d'\xe9viter que le timer reste en m\xe9moire au d\xe9montage du composant."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"en-r\xe9sum\xe9",children:"En r\xe9sum\xe9"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Syntaxe"}),(0,t.jsx)(n.th,{children:"Fr\xe9quence d'ex\xe9cution"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"useEffect(() => {})"})}),(0,t.jsx)(n.td,{children:"\xc0 chaque rendu"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"useEffect(() => {}, [])"})}),(0,t.jsx)(n.td,{children:"Une seule fois apr\xe8s le premier rendu"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"useEffect(() => {}, [x])"})}),(0,t.jsxs)(n.td,{children:["Apr\xe8s le premier rendu, puis \xe0 chaque changement de ",(0,t.jsx)(n.code,{children:"x"})]})]})]})]}),"\n",(0,t.jsx)(n.p,{children:"Si un nettoyage en m\xe9moire est requis (ex : timer, abonnement \xe0 un \xe9v\xe9nement, etc.), effectuer le nettoyage dans une fonction de retour."})]})}function u(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>d});var r=s(6540);const t={},c=r.createContext(t);function a(e){const n=r.useContext(c);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(c.Provider,{value:n},e.children)}}}]);